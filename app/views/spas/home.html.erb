<div class="banner mb-3" style="background-image: url(https://images.unsplash.com/photo-1438755582627-221038b62986?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);">
    <div class="banner-content p-5">
      <h2 class="mb-3">Find the Perfect Spa</h2>
      <h2>Anywhere, Around the World</h2>
      <p class="fst-italic mt-4">Discover experiences in our curated list of top-notch places </p>
      <%= link_to 'Become a Host / Add your Spa & Join Us', new_spa_path, class:"default-btn btn text-dark" %>
    </div>
  </div>
</div>

<div class="row">
  <div class="p-3 d-flex flex-column col-4" data-controller="toggle-create-spa-form">
    <button class="btn default-btn mx-auto mb-4" data-action="click->toggle-create-spa-form#fire">Create a Spa</button>

    <div class="registration-form w-75 mt-2 mb-3 p-4 d-none" data-toggle-create-spa-form-target="spa_form">
      <%= simple_form_for @spa, html: { multipart: true } do |f| %>
        <div class="form-group mt-3">
          <%= f.input_field :name, label: false, placeholder: 'The Name of your Spa', class: "form-control" %>
        </div>

        <div class="form-group">
          <%= f.input_field :address,
                            input_html: { data: {address_autocomplete_target: "address"}},
                            wrapper_html: { data: { controller: "address-autocomplete", address_autocomplete_api_key_value: ENV['MAPBOX_API_KEY']}},
                            label: false, placeholder: 'The Address', class: "form-control d-none" %>
        </div>

        <div class="form-group">
          <%= f.input_field :price, label: false, placeholder: 'Add a Price per session/day', class: "form-control" %>
        </div>

        <div class="form-group">
          <%= f.input_field :rating, label: false, placeholder: 'How many stars?', class: "form-control" %>
        </div>

        <div class="form-group">
          <%= f.input :images, as: :file, input_html: { multiple: true }, label: false, placeholder: 'Add Photos' %>
        </div>

        <div class="form-group d-flex justify-content-center mb-5">
          <%= f.button :submit, class: 'btn default-btn' %>
        </div>
      <% end %>
    </div>

  <div style="width: 100%; height: 600px;"
    data-controller="map"
    data-map-markers-value="<%= @markers.to_json %>"
    data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>
  </div>

  <%= turbo_frame_tag 'spas', class: "d-flex p-3 col-8 row" do %>
    <% @spas.each do |spa| %>
      <div class="col-4 card m-1 item-animate">
        <div id="carouselExampleIndicators<%= spa.id %>" class="carousel slide carousel-fade" data-bs-ride="carousel">
          <div class="carousel-inner">
            <% if spa.images.attached? %>
              <% spa.images.each_with_index do |image, index| %>
                <div class="carousel-item <%= 'active' if index.zero? %>">
                  <%= image_tag image, class: 'd-block w-100' %>
                </div>
             <% end %>
            <% else %>
              <div class="carousel-item active">
                <div class="card-img" style="background-image: url(https://media.timeout.com/images/105596637/image.jpg)"></div>
              </div>
            <% end %>
          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators<%= spa.id %>" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators<%= spa.id %>" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
          </button>
        </div>
        <div class="card-info">
          <p class="text-title"><%= spa.name %></p>
          <div class="card-location">
            <i class="fa-solid fa-location-pin" style="color: #000000;"></i> <p class="text-body"><%= spa.address %></p>
          </div>
        </div>
        <div class="card-footer">
          <span class="text-title">$<%= spa.price %> / day</span>
          <div class="card-button">
            <%= spa.rating %>  <i class="fa-solid fa-star" style="color: #ffea00;"></i>
          </div>
      </div>
      <%= link_to " Book now", new_spa_booking_path(spa) %>
      </div>
    <% end %>
  <% end %>
